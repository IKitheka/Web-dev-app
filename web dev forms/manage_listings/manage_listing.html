<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Intern Connect | Manage Listings</title>
<link rel="icon" href="/static/images/title.png">
<link rel="stylesheet" href="manage_listings.css">

</head>
<body>
<svg class="bg-animation" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320">
<path fill="url(#aurora-gradient)" d="M0,128L60,138.7C120,149,240,171,360,154.7C480,139,600,85,720,96C840,107,960,181,1080,197.3C1200,213,1320,171,1380,149.3L1440,128L1440,0L1380,0C1320,0,1200,0,1080,0C960,0,840,0,720,0C600,0,480,0,360,0C240,0,120,0,60,0L0,0Z"></path>
<defs>
<linearGradient id="aurora-gradient" x1="0" y1="0" x2="1" y2="1">
<stop offset="0%" stop-color="#4f46e5"/>
<stop offset="50%" stop-color="#06b6d4"/>
<stop offset="100%" stop-color="#8b5cf6"/>
</linearGradient>
</defs>
</svg>

<header class="header">MANAGE LISTINGS</header>

<nav class="nav">
<a href="#">INTERN CONNECT</a>
<a href="#">Dashboard</a>
<a href="#">Post a Job</a>
<a class="active" href="#">Manage Listings</a>
<a href="#">Applicants</a>
<a href="#">Profile</a>
<a href="#" style="margin-left: auto;">Log out</a>
</nav>

<div class="content">
<div id="message" class="message"></div>
<h1 class="welcome">Your Internship Listings</h1>

<div class="table-section">
<table class="apps-table" id="listingsTable">
<thead>
<tr>
<th>Title</th>
<th>Location</th>
<th>Duration</th>
<th>Start</th>
<th>End</th>
<th>Actions</th>
</tr>
</thead>
<tbody>
<tr data-id="1">
<td class="title">UI/UX Designer</td>
<td class="location">Remote</td>
<td class="duration">3 months</td>
<td class="start-date">01/06/2025</td>
<td class="end-date">31/08/2025</td>
<td>
<button class="btn edit-btn" onclick="editListing(1)">Edit</button>
<button class="btn btn-danger delete-btn" onclick="deleteListing(1)">Delete</button>
</td>
</tr>
<tr data-id="2">
<td class="title">Software Engineer Intern</td>
<td class="location">Nairobi</td>
<td class="duration">6 months</td>
<td class="start-date">01/05/2025</td>
<td class="end-date">01/11/2025</td>
<td>
<button class="btn edit-btn" onclick="editListing(2)">Edit</button>
<button class="btn btn-danger delete-btn" onclick="deleteListing(2)">Delete</button>
</td>
</tr>
</tbody>
</table>
</div>
</div>

<!-- Edit Modal -->
<div id="editModal" class="modal">
<div class="modal-content">
<span class="close" onclick="closeEditModal()">&times;</span>
<h2>Edit Internship Listing</h2>
<form id="editForm">
<input type="hidden" id="editId">
<div class="form-group">
<label class="form-label" for="editTitle">Title:</label>
<input type="text" id="editTitle" class="form-input" required>
</div>
<div class="form-group">
<label class="form-label" for="editLocation">Location:</label>
<input type="text" id="editLocation" class="form-input" required>
</div>
<div class="form-group">
<label class="form-label" for="editDuration">Duration:</label>
<input type="text" id="editDuration" class="form-input" required>
</div>
<div class="form-group">
<label class="form-label" for="editStartDate">Start Date:</label>
<input type="date" id="editStartDate" class="form-input" required>
</div>
<div class="form-group">
<label class="form-label" for="editEndDate">End Date:</label>
<input type="date" id="editEndDate" class="form-input" required>
</div>
<button type="submit" class="btn">Save Changes</button>
<button type="button" class="btn btn-danger" onclick="closeEditModal()" style="margin-left: 1rem;">Cancel</button>
</form>
</div>
</div>

<!-- Delete Confirmation Modal -->
<div id="deleteModal" class="modal">
<div class="modal-content">
<span class="close" onclick="closeDeleteModal()">&times;</span>
<h2>Confirm Deletion</h2>
<p style="color: rgba(255, 255, 255, 0.9); margin-bottom: 2rem;">
Are you sure you want to delete the internship listing "<span id="deleteTitle"></span>"? This action cannot be undone.
</p>
<button class="btn btn-danger" onclick="confirmDelete()">Yes, Delete</button>
<button class="btn" onclick="closeDeleteModal()" style="margin-left: 1rem;">Cancel</button>
</div>
</div>

<footer class="footer">Intern Connect &copy; 2025 | All Rights Reserved</footer>

<script>
let currentEditId = null;
let currentDeleteId = null;

// Function to show messages
function showMessage(text, type) {
    const messageEl = document.getElementById('message');
    messageEl.textContent = text;
    messageEl.className = `message ${type}`;
    messageEl.style.display = 'block';
    
    // Auto hide after 5 seconds
    setTimeout(() => {
        messageEl.style.display = 'none';
    }, 5000);
}

// Function to format date for display
function formatDateForDisplay(dateString) {
    const options = { day: '2-digit', month: '2-digit', year: 'numeric' };
    return new Date(dateString).toLocaleDateString('en-GB', options);
}

// Function to format date for input
function formatDateForInput(dateString) {
    // Convert from DD/MM/YYYY to YYYY-MM-DD
    const parts = dateString.split('/');
    if (parts.length === 3) {
        return `${parts[2]}-${parts[1].padStart(2, '0')}-${parts[0].padStart(2, '0')}`;
    }
    return dateString;
}

// Function to edit a listing
function editListing(id) {
    currentEditId = id;
    const row = document.querySelector(`tr[data-id="${id}"]`);
    
    if (row) {
        // Get current values
        const title = row.querySelector('.title').textContent;
        const location = row.querySelector('.location').textContent;
        const duration = row.querySelector('.duration').textContent;
        const startDate = row.querySelector('.start-date').textContent;
        const endDate = row.querySelector('.end-date').textContent;
        
        // Populate the edit form
        document.getElementById('editId').value = id;
        document.getElementById('editTitle').value = title;
        document.getElementById('editLocation').value = location;
        document.getElementById('editDuration').value = duration;
        document.getElementById('editStartDate').value = formatDateForInput(startDate);
        document.getElementById('editEndDate').value = formatDateForInput(endDate);
        
        // Show the modal
        document.getElementById('editModal').style.display = 'block';
    }
}

// Function to close edit modal
function closeEditModal() {
    document.getElementById('editModal').style.display = 'none';
    currentEditId = null;
}

// Function to delete a listing
function deleteListing(id) {
    currentDeleteId = id;
    const row = document.querySelector(`tr[data-id="${id}"]`);
    
    if (row) {
        const title = row.querySelector('.title').textContent;
        document.getElementById('deleteTitle').textContent = title;
        document.getElementById('deleteModal').style.display = 'block';
    }
}

// Function to close delete modal
function closeDeleteModal() {
    document.getElementById('deleteModal').style.display = 'none';
    currentDeleteId = null;
}

// Function to confirm deletion
function confirmDelete() {
    if (currentDeleteId) {
        const row = document.querySelector(`tr[data-id="${currentDeleteId}"]`);
        const title = row.querySelector('.title').textContent;
        
        if (row) {
            // Add fade out animation
            row.style.transition = 'opacity 0.3s ease-out';
            row.style.opacity = '0';
            
            setTimeout(() => {
                row.remove();
                showMessage(`Internship listing "${title}" has been deleted successfully.`, 'success');
            }, 300);
        }
        
        closeDeleteModal();
    }
}

// Handle edit form submission
document.getElementById('editForm').addEventListener('submit', function(e) {
    e.preventDefault();
    
    if (currentEditId) {
        const row = document.querySelector(`tr[data-id="${currentEditId}"]`);
        
        if (row) {
            // Get form values
            const title = document.getElementById('editTitle').value;
            const location = document.getElementById('editLocation').value;
            const duration = document.getElementById('editDuration').value;
            const startDate = document.getElementById('editStartDate').value;
            const endDate = document.getElementById('editEndDate').value;
            
            // Update the table row
            row.querySelector('.title').textContent = title;
            row.querySelector('.location').textContent = location;
            row.querySelector('.duration').textContent = duration;
            row.querySelector('.start-date').textContent = formatDateForDisplay(startDate);
            row.querySelector('.end-date').textContent = formatDateForDisplay(endDate);
            
            // Add update animation
            row.style.transition = 'background-color 0.5s ease';
            row.style.backgroundColor = 'rgba(34, 197, 94, 0.2)';
            
            setTimeout(() => {
                row.style.backgroundColor = '';
            }, 2000);
            
            showMessage(`Internship listing "${title}" has been updated successfully.`, 'success');
            closeEditModal();
        }
    }
});

// Close modals when clicking outside
window.onclick = function(event) {
    const editModal = document.getElementById('editModal');
    const deleteModal = document.getElementById('deleteModal');
    
    if (event.target === editModal) {
        closeEditModal();
    }
    if (event.target === deleteModal) {
        closeDeleteModal();
    }
}

// Close modals with Escape key
document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
        closeEditModal();
        closeDeleteModal();
    }
});

// Add some sample data on page load for demonstration
document.addEventListener('DOMContentLoaded', function() {
    console.log('Manage Listings page loaded successfully');
    
    // Check if table is empty and show appropriate message
    const tableBody = document.querySelector('#listingsTable tbody');
    if (tableBody.children.length === 0) {
        const emptyRow = document.createElement('tr');
        emptyRow.innerHTML = `
            <td colspan="6" style="text-align: center; padding: 2rem; color: rgba(255, 255, 255, 0.7);">
                No internship listings found. <a href="#" style="color: var(--color-cyan-300);">Post your first listing</a>
            </td>
        `;
        tableBody.appendChild(emptyRow);
    }
});
</script>
</body>
</html>